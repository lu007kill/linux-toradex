// SPDX-License-Identifier: GPL-2.0+ OR X11
/*
 * Copyright 2018-2019 Toradex
 */

/ {
	aliases {
		rtc0 = &rtc_i2c;
		rtc1 = &rtc;
	};

	display-subsystem {
		status = "disabled";
	};

	extcon_usbc_det: usbc_det {
		compatible = "linux,extcon-usb-gpio";
		debounce = <25>;
		id-gpio = <&gpio5 9 GPIO_ACTIVE_HIGH>;
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_usbc_det>;
	};

	panel {
		compatible = "panel-dpi";
		backlight = <&backlight>;
		enable-gpios = <&gpio4 19 GPIO_ACTIVE_HIGH>;
		power-supply = <&reg_3v3>;

		width-mm = <154>;
		height-mm = <86>;

		data-mapping = "bgr666";

		panel-timing {
			clock-frequency = <33300000>;
			hactive = <800>;
			hback-porch = <46>;
			hfront-porch = <210>;
			hsync-len = <20>;
			vactive = <480>;
			vback-porch = <23>;
			vfront-porch = <22>;
			vsync-len = <10>;
			pixelclk-active = <1>;
		};

		port {
			lcd_panel_in: endpoint {
				remote-endpoint = <&lcd_display_out>;
			};
		};
	};

	regulators {
		reg_usbh_vbus: regulator-usbh-vbus {
			compatible = "regulator-fixed";
			pinctrl-names = "default";
			pinctrl-0 = <&pinctrl_usbh1_reg>;
			regulator-name = "usbh_vbus";
			regulator-min-microvolt = <5000000>;
			regulator-max-microvolt = <5000000>;
			gpio = <&gpio4 3 GPIO_ACTIVE_LOW>;
			regulator-always-on;
		};
	};
};

&adma_lcdif {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_lcdif>;
	bus-width = <18>;
	status = "okay";

	port@0 {
		lcd_display_out: lcdif-endpoint {
			remote-endpoint = <&lcd_panel_in>;
		};
	};
};

&backlight {
	status = "okay";
};

&dpu1 {
	status = "okay";
};

&gpu_3d0 {
	status = "okay";
};

&i2c1 {
	status = "okay";

	/* M41T0M6 real time clock on carrier board */
	rtc_i2c: rtc@68 {
		compatible = "st,m41t0";
		reg = <0x68>;
	};
};

&imx8_gpu_ss {
	status = "okay";
};

/* Colibri SPI */
&lpspi2 {
	status = "okay";

	spidev0: spidev@0 {
		compatible = "toradex,evalspi";
		reg = <0>;
		spi-max-frequency = <10000000>;
	};
};

&lpuart3 {
	status= "okay";
};

/* Colibri PWM_A */
&pwm_adma_lcdif {
	status = "okay";
};

&usbotg1 {
	extcon = <&extcon_usbc_det &extcon_usbc_det>;
	vbus-supply = <&reg_usbh_vbus>;
	srp-disable;
	hnp-disable;
	adp-disable;
	power-polarity-active-high;
	disable-over-current;
	status = "okay";
};

&usbotg3 {
	dr_mode = "host";
	status = "okay";
};

&vpu {
	status = "disabled";
};

&vpu_decoder {
	status = "okay";
};

&vpu_encoder {
	status = "okay";
};
